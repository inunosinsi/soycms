<!-- soy:id="nav" /-->

<br>

<div class="alert alert-success" soy:display="updated">更新しました</div>
<div class="alert alert-success" soy:display="deleted">削除しました</div>
<div class="alert alert-danger" soy:display="error">失敗しました</div>

<div class="table-responsive">
	<table class="table table-striped">
	    <caption>サーチフィールド</caption>
	    <tr>
	        <th>ID</th>
	        <th>ラベル</th>
	        <th>タイプ</th>
			<th>操作</th>
	        <th>表示順</th>
	        <th>表示のさせ方</th>
	        <th>&nbsp;</th>
	    </tr>

	    <!-- soy:id="field_list" -->
	    <tr>
	        <td soy:id="key"></td>
	        <td>
				<span soy:id="label">説明</span>
				<input soy:id="label_input" style="display:none;">
			</td>
	        <td soy:id="type"></td>
			<td>
				<a soy:id="toggle_update" class="btn btn-primary btn-sm">設定変更</a>
				<a soy:id="update_link" class="btn btn-primary btn-sm" style="display:none;">変更を保存する</a>
				<form method="post">
					<input type="hidden" name="obj[label]" soy:id="label_input_hidden">
					<input type="submit" soy:id="update_submit" style="display:none;">
				</form>
			</td>
	        <td>
	                <form method="post">
	                    <input type="hidden" soy:id="field_id" />
	                    <input type="submit" name="move_up" class="btn btn-default" value="△" />
	                    <input type="submit" name="move_down" class="btn btn-default" value="▽" />
	                </form>
	        </td>
	        <td soy:id="display"></td>
	        <td>
	            <a soy:id="toggle_config" class="btn btn-warning">Detail</a>&nbsp;
	            <a soy:id="delete" class="btn btn-danger">Delete</a>
	            <form method="post">
	                <input type="submit" soy:id="delete_submit" style="display:none;" />
	            </form>
	        </td>
	    </tr>
	    <tr soy:id="field_config" style="display:none;">
	        <td colspan="3"></td>
	        <td colspan="3">
	            <h5 style="margin-bottom:0;">詳細設定</h5>

	            <form method="post">
	                <div class="form-group">
						<label>カテゴリとの関連付け</label><br>
						<select soy:id="show_input"><option></option></select>
					</div>

					<!-- soy:id="is_denial" -->
					<div class="form-group">
						<label>検索時に否定(○○がない)の項目として使用する</label><br>
						<input type="checkbox" soy:id="denial">
					</div>
					<!-- /soy:id="is_denial" -->

					<!-- soy:id="with_options" -->
					<div class="form-group">
	                    <label>選択項目<span class="option">(項目を改行で区切ってください)</span></label><br>
	                    <!-- soy:id="multi_lang_list" -->
						<br>
                        <span soy:id="label_area"><strong soy:id="multi_language_label"></strong>用の項目</span>
                        <textarea soy:id="option" class="form-control"></textarea><br>
						<div class="alert alert-warning">※項目名の前に*を付けると公開側の検索フォームで選択された状態で表示されます。</div>
						<!-- /soy:id="multi_lang_list" -->
					</div>
					<!-- /soy:id="with_options" -->

					<!-- soy:id="with_other_item" -->
					<div class="form-group">
						<label>その他の項目</label><br>
						<input type="checkbox" soy:id="use_other_item">
					</div>
					<!-- /soy:id="with_other_item" -->

					<!-- soy:id="radio_search_form_default_area" -->
					<div class="form-group">
	                    <label>ラジオの項目の設定</label><br>
	                    <input type="checkbox" soy:id="radio_search_form_default">
					</div>
					<!-- /soy:id="radio_search_form_default_area" -->

					<!-- soy:id="sitemap_option_area" -->
					<div class="form-group">
	                    <label>サイトマップに追加する</label><br>
						<select soy:id="custom_search_item_list_page"><option></option></select>
					</div>
					<!-- /soy:id="sitemap_option_area" -->

					<div class="form-group">
	                    <label>一括設定</label><br>
                        <a href="" soy:id="setting_link" class="btn btn-default">一括設定ページを開く</a>
					</div>

					<!-- soy:id="checkbox_tag_supple_area" -->
					<div class="form-group">
	                    <label>公開側のページで項目を個別に表示する場合</label><br>
	                    <pre soy:id="checkbox_tag_supple" style="overflow-x:scroll;"></pre>
					</div>
					<!-- /soy:id="checkbox_tag_supple_area" -->

					<!-- soy:id="is_custom_field" -->
					<div class="form-group">
						<label>カスタムサーチフィールドのカスタムフィールド</label><br>
						<a soy:id="custom_field_form_link" class="btn btn-default">設定画面を開く</a>
	                </div>
					<!-- /soy:id="is_custom_field" -->

	                <div class="text-right">
	                    <input type="button" soy:id="update_advance" class="btn btn-primary btn-lg" value="設定保存">
	                </div>

	                <input type="submit" style="display:none;" soy:id="update_advance_submit" />
	            </form>

	        </td>
	    </tr>
	    <!-- /soy:id="field_list" -->
	</table>
</div>

<br>

<h4>フィールドID_visible</h4>
<p>csf:id="<strong>フィールドID_visible</strong>"またはcsf:id="<strong>フィールドID_is_not_empty</strong>"で囲った箇所は、csf:id="フィールドID"の値が空の時に表示されなくなります。<br>
csf:id="<strong>フィールドID_is_empty</strong>"で囲った箇所は、csf:id="フィールドID"の値が空ではない時に表示されます。</p>
<br>
<span>例:フィールドIDがsampleの時</span>
<pre>&lt;div <strong>csf:id="sample_visible"</strong>&gt;
カスタムフィールドの値は<strong>&lt;!-- csf:id="sample" /--&gt;</strong>です。
&lt;/div&gt;
&lt;div <strong>csf:id="sample_is_empty"</strong>&gt;
カスタムフィールドの値は空です。
&lt;/div&gt;</pre>

<br>

<h4 style="margin:10px 0;">テンプレートへの記述例</h4>
<pre style="overflow-x: auto;" class="script_example">
&lt;!-- shop:module="common.custom_search_field" --&gt;
&lt;form action="{作成した検索ページのURLを入力してください}"&gt;
    商品名:
    &lt;input type="text" csf:id="custom_search_item_name"&gt;

    商品コード:
    &lt;input type="text" csf:id="custom_search_item_code"&gt;

    価格:
    &lt;input type="number" csf:id="custom_search_item_price_min"&gt;～&lt;input type="number" csf:id="custom_search_item_price_max"&gt;

<!-- soy:id="example_tag_list" -->
<!-- /soy:id="example_tag_list" -->

	フリーワード検索
	&lt;input type="text" csf:id="custom_search_csf_free_word"&gt;

	<!-- soy:display="connect_reserve_calendar" --><strong>簡易予約カレンダーとの連携</strong> (jQuery等のdatepickerの使用を推奨)
	予約が可能なプランの期間検索
	&lt;input type="text" csf:id="custom_search_reserve_calendar_start"&gt;〜&lt;input type="text" csf:id="custom_search_reserve_calendar_end"&gt;
	<!-- /soy:display="connect_reserve_calendar" -->

    &lt;input type="submit" value="検索する"&gt;
	&lt;a csf:id="reset_link"&gt;リセット&lt;/a&gt;
&lt;/form&gt;
&lt;!-- /shop:module="common.custom_search_field" --&gt;
</pre>

<br>

<h4>検索結果ページの設定</h4>
<ul style="list-style-type: decimal;margin-bottom:10px;">
    <li>ページの追加から、検索結果ページを作成する。</li>
    <li>作成した検索結果ページの編集から、<strong>検索モジュールの設定</strong>を開き、<strong>Custom Search Field</strong>を選び、更新する。</li>
    <li>公開側ページにフォームを設置する</li>
</ul>

<br>

<h4>商品一覧ページの設定</h4>
<ul style="list-style-type: decimal;margin-bottom:10px;">
    <li>商品一覧用のページを新たに作成し、商品一覧ページの設定でその他を選び、<strong>CustomSearchFieldItemList</strong>を選びます。</li>
    <li>カスタムサーチフィールドで商品を選択する場合は<strong>http://ドメイン/{ショップID}/{URI}/{サーチフィールドID}/{フィールドの値}</strong>になります。</li>
</ul>

<br>


<h4>商品一覧ページと検索結果ページで使用できるソート用リンクタグ</h4>
<pre style="border:1px solid #000000;padding:5px 20px 0 5px;margin:5px 35px 10px 5px; overflow-x: auto;" class="script_example">
<!-- soy:id="field_list*" -->
&lt;a css:id="custom_search_sort_<!-- soy:id="key" /-->_asc"&gt;<!-- soy:id="label" /-->の昇順&lt;/a&gt;
&lt;a css:id="custom_search_sort_<!-- soy:id="key*" /-->_desc"&gt;<!-- soy:id="label*" /-->の降順&lt;/a&gt;
<!-- /soy:id="field_list*" -->
</pre>

<br>

<h4>商品一覧ページを開いた直後にソートを反映する方法</h4>
<ul style="margin-bottom:10px;">
    <li>一覧ページへのURLの末尾に?custom_search_sort=フィールドID&r=0を追加</li>
    <li>rの値は0は昇順で1が降順になります</li>
</ul>


<div class="modal" tabindex="-1" role="dialog" id="customfieldModal">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">項目の追加</h5>
			</div>
			<div class="modal-body">
				<form soy:id="create_form" id="create_form">
			        <input type="hidden" name="create" value="create">
			        <div>
			            ID
			            <div class="alL">
			            <input id="custom_key" name="custom_key" type="text" class="form-control validate">
						<div class="alert alert-warning" soy:display="installed_customfield">カスタムフィールドで追加したIDは使用しないでください。</div>
			            <p class="alert alert-danger" id="custom_key_error" style="display:none;">必須項目を入力してください</p>
			            </div>

			            ラベル

			            <div class="alL">
			            <input id="custom_label" name="custom_label" type="text" class="form-control validate">
			            <p class="alert alert-danger" id="custom_label_error" style="display:none;">必須項目を入力してください</p>
			            </div>


			            項目種別
			            <div class="alL">
			                <select name="custom_type" soy:id="custom_type_select"></select>
			            </div>

			        </div>
			        <div class="text-right">
			            <a class="btn btn-primary" href="javascript:void(0);" onclick="$('#create_form').trigger('submit');">追加</a>
			        </div>
			    </form>
			</div>
			<div class="modal-footer">
				<button type="button" id="customfieldModal" class="btn btn-secondary" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

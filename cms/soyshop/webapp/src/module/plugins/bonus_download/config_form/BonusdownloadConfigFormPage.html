<!-- soy:id="display_download_assistant_plugin_install" -->
<div class="section">
	<h3 style="margin-top:5px;">ダウンロード販売補助プラグインをインストール</h3>
	<div class="ml20 mb20">
		<p>購入特典ダウンロードプラグインをご利用頂くには、ダウンロード販売補助プラグインをインストールする必要があります。</p>
		<p>インストールは<a soy:id="download_assitant_plugin_link">こちらから</a>。</p>
	</div>
</div>
<!-- /soy:id="display_download_assistant_plugin_install" -->

<!-- soy:id="display_download_assistant_plugin_not_install" -->
<p class="alert alert-success" soy:id="notice_updated">変更しました</p>
<p class="alert alert-success" soy:id="notice_bonus_file_uploaded">ファイルをアップロードしました</p>
<p class="alert alert-success" soy:id="notice_bonus_file_uploaded_fail">ファイルをアップロードに失敗しました</p>
<p class="alert alert-success" soy:id="notice_bonus_file_deleted">ファイルを削除しました</p>

<h1>ファイルアップロード</h1>
<form soy:id="upload_form" id="upload_form" enctype="multipart/form-data">
<dl>
	<dt>
		購入特典ファイル設定<br />
		<span style="font-size:0.9em;padding:5px 0;">※登録可能なファイルの拡張子&nbsp;:&nbsp;<strong><!-- soy:id="bonus_file_type_list_text" /--></strong></span>
	</dt>
	<dd>
		<input type="file" soy:id="bonus_file_upload" id="bonus_file">
		<p>ディレクトリパス&nbsp;:&nbsp;<strong><!-- soy:id="bonus_file_dir" /--></strong></p>
		<br />
		<!-- soy:id="display_bonus_files" -->
		<h3>登録されているファイル</h3>
		<ul>
			<!-- soy:id="bonus_file_list" -->
			<li style="padding:3px;"><!-- soy:id="bonus_file_name" /-->&nbsp;<!-- soy:id="bonus_file_size" /-->&nbsp;<a class="btn btn-default" soy:id="bonus_file_delete_link" onclick="return confirm('このファイルを削除しますか？')">削除</a></li>
			<!-- /soy:id="bonus_file_list" -->
		</ul>
		<!-- /soy:id="display_bonus_files" -->
		<input type="hidden" id="delete_filename" name="delete_filename"  value="">
	</dd>
</dl>

<div class="text-center">
	<input type="submit" class="btn btn-primary btn-lg" value="アップロード" name="submit_upload" id="submit_upload">
</div>

</form>

<h1>購入特典 設定</h1>
<form soy:id="content_form" enctype="multipart/form-data">
<dl>
	<dt>購入特典名&nbsp;※メール文面に出力されます</dt>
	<dd>
		<input type="text" soy:id="bonus_name">
	</dd>
	<dt>購入特典内容のHTML&nbsp;※カート画面に出力されます</dt>
	<dd>
		<textarea soy:id="bonus_html"></textarea>
	</dd>
	<dt>購入特典タイプ</dt>
	<dd>
		<input type="radio" soy:id="bonus_type_file" /><label for="bonus_type_file">アップロードしたファイルから選択</label><br />
		<input type="radio" soy:id="bonus_type_text" /><label for="bonus_type_text">URLを出力</label>&nbsp;
	</dd>

</dl>

<div id="bonus_type_file_area">
<dl>
	<dt>購入特典ファイル選択</dt>
	<dd>
		<!-- soy:id="display_bonus_files*" -->
		<!-- soy:id="bonus_file_selected_list" -->
		<input type="checkbox" soy:id="bonus_file_checkbox"><label soy:id="bonus_file_label"><!-- soy:id="bonus_file_name" /-->&nbsp;<!-- soy:id="bonus_file_size" /--></label><br />
		<!-- /soy:id="bonus_file_selected_list" -->
		<!-- /soy:id="display_bonus_files*" -->
		<!-- soy:id="display_no_bonus_files" -->
		登録されているファイルはありません。
		<!-- /soy:id="display_no_bonus_files" -->
	</dd>
	<dt>購入特典ファイル ダウンロード期間</dt>
	<dd>
		<input type="text" soy:id="bonus_download_time_limit" size="4" style="text-align:right;ime-mode:inactive;">日
		<p>※値がない場合は無期限</p>
	</dd>
</dl>
</div>

<div id="bonus_type_text_area">
<dl>
	<dt>URL</dt>
	<dd>
		<input type="text" style="width:80%;" soy:id="bonus_download_url">
	</dd>
</dl>
</div>

<dl>
	<dt>公開状態</dt>
	<dd>
		<input type="radio" soy:id="status_type_inactive" ><label for="status_type_inactive">非公開（購入特典ダウンロードを無効）</label><br />
		<input type="radio" soy:id="status_type_active" ><label for="status_type_active">公開（購入特典ダウンロードを有効）</label><br />
	</dd>
</dl>

<div class="text-center">
	<input type="submit" class="btn btn-primary btn-lg" value="設定変更" name="submit_content">
</div>


</form>

<style type="text/css">
.mb10 {
    margin-bottom: 10px !important;
}
</style>
<h1>購入特典 条件</h1>
<form soy:id="condition_form">
<dl>
	<dt>合計金額</dt>
	<dd>
		<div class="mb10">
			<input type="checkbox" soy:id="condition_price_checkbox" ><label for="condition_price_checkbox">合計金額&nbsp;を条件に含める</label>
		</div>
		<div class="condition_price_area">
			<input type="text" style="width:10%;" soy:id="condition_price_value">&nbsp;円以上の合計金額
		</div>
	</dd>
</dl>
<dl>
	<dt>合計商品数</dt>
	<dd>
		<div class="mb10">
			<input type="checkbox" soy:id="condition_amount_checkbox" ><label for="condition_amount_checkbox">合計商品数&nbsp;を条件に含める</label>
		</div>
		<div class="condition_amount_area">
			<input type="text" style="width:5%;" soy:id="condition_amount_value">&nbsp;個以上の合計商品数
		</div>
	</dd>
</dl>

<dl>
	<dt>条件の適用</dt>
	<dd>
		<span class="condition_price_area">
			[合計金額]&nbsp;
		</span>
		<span class="condition_amount_area">
			[合計商品数]&nbsp;
		</span>

		<span id="condition_combination_area">
			<input type="radio" soy:id="condition_combination_all" ><label for="condition_combination_all">両方の条件に一致</label>&nbsp;
			<input type="radio" soy:id="condition_combination_any" ><label for="condition_combination_any">片方の条件に一致</label>
		</span>
	</dd>
</dl>

<div class="text-center">
	<input type="submit" class="btn btn-primary btn-lg" value="条件変更" name="submit_condition">
</div>

</form>
<!-- /soy:id="display_download_assistant_plugin_not_install" -->

<script>

/* 購入特典内容 */
function display_bonus_type_area(args){
	$("#bonus_type_text_area").hide();
	$("#bonus_type_file_area").hide();
	$(args.data).fadeIn("slow");
}

$("#bonus_type_text").bind("click", "#bonus_type_text_area", display_bonus_type_area);
$("#bonus_type_file").bind("click", "#bonus_type_file_area", display_bonus_type_area);

if($("#bonus_type_text").prop("checked")){
	args = {data:"#bonus_type_text_area"};
}else{
	args = {data:"#bonus_type_file_area"};
}
display_bonus_type_area(args);

/* 購入特典条件 */
function display_condition_area(){
	//合計価格
	price = $("#condition_price_checkbox").prop("checked");
	if(price){
		$(".condition_price_area").fadeIn("slow");
	}else{
		$(".condition_price_area").fadeOut("slow")
	}

	//合計商品数
	amount = $("#condition_amount_checkbox").prop("checked");
	if(amount){
		$(".condition_amount_area").fadeIn("slow");
	}else{
		$(".condition_amount_area").fadeOut("slow")
	}

	//条件組み合わせ
	if(price && amount){
		$("#condition_combination_area").fadeIn("slow");
	}else{
		$("#condition_combination_area").fadeOut("slow");
	}

}

$("#condition_price_checkbox").bind("click", display_condition_area);
$("#condition_amount_checkbox").bind("click", display_condition_area);
display_condition_area();

//ファイル削除
function post_delete_bonus_file(filename){
	$("#delete_filename").val(filename);
	$("#submit_upload").trigger("click");
}

</script>

<!DOCTYPE html>
<html lang="ja">

<head soy:page="_common.HeaderPage" isOverWrite="true">
</head>

<body>

	<div id="wrapper">
		<!-- Navigation -->
		<nav  class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0" soy:page="_common.UpperMenuPage"><!-- --></nav>

		<div id="page-wrapper">

			<!-- soy:id="BlogMenu" /-->

			<form soy:id="page_detail_form">

			<div class="row">
				<div class="col-lg-9">

					<div class="panel panel-default">
						<div class="panel-heading">基本設定</div>
						<div class="panel-body">
							<div class="form-group">
								<div style="float:left;width:80%;">
									<label>ブログのタイトル<span soy:message="HELP_BLOG_TITLE"></span></label>
									<input type="text" id="title" soy:id="title" class="form-control">
								</div>
								<div id="icon">
									<img soy:id="page_icon_show" id="page_icon_show" />
									<input type="hidden" soy:id="page_icon" name="icon" id="page_icon">
									<span soy:message="HELP_BLOG_ICON"></span>
								</div>
								<div style="clear:both"><!----></div>
							</div>

							<div class="form-group">
								<label>ブログのアドレス<span soy:message="HELP_BLOG_URI"></span></label>
								<div class="input-group">
									<span id="uri_prefix" soy:id="uri_prefix" class="input-group-addon"></span><input type="text" id="uri" soy:id="uri" class="form-control">
								</div>
							</div>

							<div class="form-group">
								<label>親ページ<span soy:message="HELP_BLOG_OWNER_PAGE"></span></label>
								<select soy:id="parent_page" class="form-control">
									<option value="">----------</option>
								</select>
							</div>

							<div class="form-group" id="blog_config_description">
								<label>説明<span soy:message="HELP_BLOG_DESCRIPTION"></span></label>
								<textarea type="text" id="description" soy:id="description" class="form-control mceEditor" row="5"></textarea>
							</div>
						</div>
					</div>

				</div>

				<!-- サイドメニュー -->
				<div class="col-lg-3 hidden-xs" soy:panel="toolbox">
					<div soy:page="_common.ToolBoxPage" isOverWrite="true"></div>
				</div soy:panel="toolbox">
			</div>

			<div class="row">
				<div class="col-lg-12">

					<div class="panel panel-default">
						<div class="panel-heading">ラベルの設定</div>
						<div class="panel-body">
							<div class="form-group" id="blog_config_blog_label">
								<label>使用するラベル<span soy:message="HELP_BLOG_BLOG_LABEL"></span></label>
								<div soy:id="no_label_message"></div soy:id="no_label_message">
								<div id="use_label_list" soy:id="label_exists">
									<div id="labels_wrapper">
										<!-- soy:id="use_label_list" -->
										<div class="label_wrapper">
											<input type="radio" soy:id="label_check">
											<label soy:id="label_label">
												<img soy:id="label_icon" class="label_icon" />
												<span soy:id="label_caption" class="label label-default label-soy"></span>
											</label soy:id="label_label">
										</div>
										<!-- /soy:id="use_label_list" -->
										<br style="clear:both"/>
									</div>
								</div soy:id="label_exists">
							</div>

							<div class="" id="blog_config_category_label">
								<label>カテゴリ分けで使用するラベル<span soy:message="HELP_BLOG_CATEGORY_LABEL"></span></label>
								<div soy:id="no_label_message2"></div soy:id="no_label_message2">
								<div id="category_label_list" soy:id="label_exists2">
									<div id="labels_wrapper">
										<!-- soy:id="category_label_list" -->
										<div class="label_wrapper">
											<input type="checkbox" soy:id="label_check">
											<label soy:id="label_label">
												<img soy:id="label_icon" class="label_icon" />
												<span soy:id="label_caption" class="label label-default label-soy"></span>
											</label soy:id="label_label">
										</div>
										<!-- /soy:id="category_label_list" -->
										&nbsp;<input type="button" value="チェックを全て外す" onclick="removeAllCheck();">
										<br style="clear:both"/>
									</div>
								</div soy:id="label_exists2">
							</div>

						</div>
					</div>

					<div class="panel panel-default">
						<div class="panel-heading">ページ生成設定</div>

						<table class="table table-striped">
							<tr>
								<th nobr>ページの種類</th>
								<th nobr>生成<span soy:message="HELP_BLOG_GENERATE_FLAG"></span></th>
								<th nobr style="width: 8em;">表示件数<span soy:message="HELP_BLOG_DISPLAY_NUMBER"></span></th>
								<th nobr>URL<span soy:message="HELP_BLOG_PAGE_URL"></span></th>
								<th nobr>タイトルフォーマット<span soy:message="HELP_BLOG_TITLE_FORMAT"></span></th>
								<th nobr>表示順</th>
							</tr>
							<tr id="blog_config_top">
								<th>ブログトップ<span soy:message="HELP_BLOG_TOP"></span></th>
								<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateTopFlag" name="generateTopFlag"></td>
								<td class="blog_config_display_number">
									<span class="input-group">
										<input soy:id="top_display_count" class="validate-number short form-control" type="text">
										<span class="input-group-addon">件</span>
									</span>
								</td>
								<td class="blog_config_generate_url">
									<span class="input-group">
										<span id="uri_prefix" class="input-group-addon" soy:id="top_page_uri_prefix"></span>
										<input soy:id="top_page_uri" id="top_page_uri" type="text" class="validate-alphanumchar duplication form-control">
									</span>
								</td>
								<td class="blog_config_title_format"><input soy:id="top_title_format" type="text" class="form-control"></td>
								<td><select soy:id="top_entry_sort" class="form-control"></select></td>
							</tr>
							<tr class="even" id="blog_config_entry">
								<th>記事毎ページ<span soy:message="HELP_BLOG_ENTRY"></span></th>
								<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateEntryFlag" name="generateEntryFlag"></td>
								<td class="blog_config_display_number">&nbsp;</td>
								<td class="blog_config_generate_url">
									<span class="input-group">
										<span id="uri_prefix" class="input-group-addon" soy:id="entry_page_uri_prefix"></span>
										<input soy:id="entry_page_uri" id="entry_page_uri" type="text" class="validate-alphanumchar duplication form-control">
										<span class="input-group-addon">/&lt;記事名&gt;</span>
									</span>
								</td>
								<td class="blog_config_title_format"><input soy:id="entry_title_format" type="text" class="form-control"></td>
								<td>&nbsp;</td>
							</tr>
							<tr id="blog_config_top_archive">
								<th>月別アーカイブページ<span soy:message="HELP_BLOG_ARCHIVE"></span></th>
								<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateMonthFlag" name="generateMonthFlag"></td>
								<td class="blog_config_display_number">
									<span class="input-group">
										<input soy:id="month_display_count" class="validate-number short form-control" type="text">
										<span class="input-group-addon">件</span>
									</span>
								</td>
								<td class="blog_config_generate_url">
									<span class="input-group">
										<span id="uri_prefix" class="input-group-addon" soy:id="month_page_uri_prefix"></span>
										<input soy:id="month_page_uri" id="month_page_uri" type="text" class="validate-alphanumchar duplication form-control">
										<span class="input-group-addon">/&lt;年&gt;/&lt;月&gt;</span>
									</span>
								</td>
								<td class="blog_config_title_format"><input soy:id="month_title_format" type="text" class="form-control"></td>
								<td><select soy:id="month_entry_sort" class="form-control"></select></td>
							</tr>
							<tr class="even" id="blog_config_category">
								<th>カテゴリ別アーカイブページ<span soy:message="HELP_BLOG_CATEGORY"></span></th>
								<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateCategoryFlag" name="generateCategoryFlag"></td>
								<td class="blog_config_display_number">
									<span class="input-group">
										<input soy:id="category_display_count" class="validate-number short form-control" type="text">
										<span class="input-group-addon">件</span>
									</span>
								</td>
								<td>
									<span class="input-group">
										<span id="uri-prefix-category" class="input-group-addon" soy:id="category_page_uri_prefix"></span>
										<input soy:id="category_page_uri" id="category_page_uri" type="text" class="validate-alphanumchar duplication form-control">
										<span class="input-group-addon">/&lt;ラベル&gt;/</span>
									</span>
								</td>
								<td class="blog_config_title_format"><input soy:id="category_title_format" type="text" class="form-control"></td>
								<td><select soy:id="category_entry_sort" class="form-control"></select></td>
							</tr>
							<tr id="blog_config_feed">
								<th>フィード出力<span soy:message="HELP_BLOG_FEED"></span></th>
								<td class="blog_config_generate_flag"><input type="checkbox" soy:id="generateRssFlag" name="generateRssFlag"></td>
								<td class="blog_config_display_number">
									<span class="input-group">
										<input soy:id="rss_display_count" class="validate-number short form-control" type="text" class="form-control">
										<span class="input-group-addon">件</span>
									</span>
								</td>
								<td class="blog_config_generate_url">
									<span class="input-group">
										<span id="uri_prefix" class="input-group-addon" soy:id="rss_page_uri_prefix"></span>
										<input soy:id="rss_page_uri" id="rss_page_uri" type="text" class="validate-alphanumchar duplication form-control">
									</span>
								</td>
								<td class="blog_config_title_format"><input soy:id="feed_title_format" type="text" class="form-control"></td>
								<td>&nbsp;</td>
							</tr>
						</table>
					</div>

					<div class="panel panel-default">
						<div class="panel-heading">b_block使用設定</div>
						<div class="panel-body">
							<!-- soy:id="b_block_config_checks" /-->
						</div>
					</div>

					<!-- soy:display="openperiod_section" -->
					<div class="panel panel-default">
						<div class="panel-heading">公開設定</div>
						<div class="panel-body">
							<div class="row">
								<div class="col-lg-6">
									<label>公開設定<span soy:message="HELP_BLOG_DRAFT"></span></label>
									<input type="radio" soy:id="state_draft">
									<input type="radio" soy:id="state_public">
								</div>

								<div class="col-lg-6" id="blog_config_open_period">
									<label>公開期間<span soy:message="HELP_BLOG_OPEN_PERIOD"></span></label>
									<span soy:id="open_period_show" id="open_period_show"></span>
									<button class="btn btn-default btn-sm" id="open_period_show_button" type="button" onclick="$('#open_period_show').hide();$('#open_period_input').show();$('#open_period_show_button').hide();">公開期間を設定する</button>
									<div id="open_period_input" style="display:none;">
										<table style="width: 28em">
											<tr>
												<td style="vertical-align:top;">
													<input class="form-control" type="text" soy:id="start_date" id="start_date" size="25" maxlength="19" style="width:100%">

													<div style="font-size:10px;margin-top:5px;margin-left:5px;">
														<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),true,false));return false;">今日</a><br/>
														<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,1,0,0,0),true,false));return false;">明日</a><br/>
														<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,7,0,0,0),true,false));return false;">来週</a><br/>
														<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,1,0,0,0,0),true,false));return false;">来月</a><br/>
														<a href="#" onclick="$('#start_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),false,false));return false;">現在の時刻</a><br/>
														<a href="#" onclick="$('#start_date').val('');return false;">日時のクリア</a>
													</div>
												</td>
												<td style="vertical-align:top;text-align:center;width:4em;">から</td>
												<td style="vertical-align:top;">
													<input class="form-control" type="text" soy:id="end_date" id="end_date" size="25" maxlength="19" style="width:100%">
													<div style="font-size:10px;">
														<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,1,0,0,0),true,true));return false;">明日</a><br/>
														<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,7,0,0,0),true,true));return false;">来週</a><br/>
														<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,1,0,0,0,0),true,true));return false;">来月</a><br/>
														<a href="#" onclick="$('#end_date').val(buildDateString(movedate(new Date,0,0,0,0,0,0),false,true));return false;">現在の時刻</a><br/>
														<a href="#" onclick="$('#end_date').val('');return false;">日時のクリア</a>
													</div>
												</td>
											</tr>
										</table>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- /soy:display="openperiod_section" -->

					<div class="form-group">
						<button type="submit" class="btn btn-primary btn-block btn-lg">更新</button>
					</div>

					<!-- サイドメニュー（スマホ用） -->
					<div class="visible-xs" soy:panel="toolbox"></div>

				</div>

			</div>

			</form soy:id="page_detail_form">

		</div>
		<!-- /#page-wrapper -->

		<!-- soy:page="_common.FooterPage" /-->

	</div>
	<!-- /#wrapper -->

	<div id="image_list" style="width:100%;height:100%;display:none;">
		<h4>ダブルクリックで変更</h4>
		<span soy:id="image_list">
			<img soy:id="image_list_icon" style="width:64px;height:64px;">
		</span soy:id="image_list">
	</div>

<script type="text/javascript">
	function changeImageIcon(id){
		common_element_to_layer($("#image_list"), {
			width : 200,
			height : 150,
			targetId : "image_list_layer",
			onclose : function(){
				$("body").append($("#image_list"));
				$("#image_list").hide();
			}
		});
		$("#image_list").prop("label_id", id);
		$("#image_list").show();
	}

	function setChangeLabelIcon(filename,fileAddress){
		$("#page_icon").val(filename);
		$("#page_icon_show").attr("src", fileAddress);

		//消し方がわからないのでとりあえず隠す
		common_close_layer_by_targetId("image_list_layer");
	}

	function create_label(){
		var str = prompt("新しいラベル名を入力してください","");
		if(str == null) return;

		$.ajax({
			method : "post",
			url : CreateLabelLink,
			data : {
				caption : encodeURI(str)
			},
			success : function(result){
				var obj = eval('('+result+')');
				if(obj.result == 1){
					var $wrapper = $("<div>");
					$wrapper.addClass("label_wrapper");

					var $checkbox = $("<input>");
					$checkbox.attr({
						id : "blogLabelId_" + obj.labelId,
						type : "radio",
						name : "blogLabelId"
					});
					$checkbox.val(obj.labelId);

					var $label = $("<label>");
					$label.attr({
						"for" : $checkbox.attr("id")
					});

					var $img = $("<img>");
					$img.addClass("label_icon");
					$img.attr("src", "/soycms/image/labelicon/default.gif");

					var $span = $("<span>");
					$span.addClass("label_caption");
					$span.css({
						color : "#000000",
						"background-color" : "#FFFFFF"
					});
					$span.text(str);

					$label.append($img);
					$label.append($span);
					$wrapper.append($checkbox);
					$wrapper.append($label);

					$("#use_label_list .label_wrapper:last").after($wrapper);

					//

					var $wrapper = $("<div>");
					$wrapper.addClass("label_wrapper");

					var $checkbox = $("<input>");
					$checkbox.attr({
						id : "categoryLabelList_" + obj.labelId,
						type : "checkbox",
						name : "categoryLabelList[]"
					});
					$checkbox.val(obj.labelId);

					var $label = $("<label>");
					$label.attr({
						"for" : $checkbox.attr("id")
					});

					var $img = $("<img>");
					$img.addClass("label_icon");
					$img.attr("src", "/soycms/image/labelicon/default.gif");

					var $span = $("<span>");
					$span.addClass("label_caption");
					$span.css({
						color : "#000000",
						"background-color" : "#FFFFFF"
					});
					$span.text(str);

					$label.append($img);
					$label.append($span);
					$wrapper.append($checkbox);
					$wrapper.append($label);

					$("#category_label_list .label_wrapper:last").after($wrapper);
				}
				alert(obj.message);
			},
			error : function(){
				alert("失敗");
			}
		});
	}
	//使用するカテゴリでチェックしてあるカテゴリをすべて外す
	function removeAllCheck(){
		$("[name='categoryLabelList[]']").each(function(){
			$(this).removeAttr('checked');
		});
	}
</script>

<!-- soy:id="entry_editor_javascripts" /-->

</body>
</html>
